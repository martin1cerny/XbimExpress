// ------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version: 14.0.0.0
//  
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
// ------------------------------------------------------------------------------
namespace Xbim.CodeGeneration.Templates.CrossAccess
{
    using System.Linq;
    using System.Text;
    using System.Collections.Generic;
    using Xbim.ExpressParser.SDAI;
    using System;
    
    /// <summary>
    /// Class to produce the template output
    /// </summary>
    
    #line 1 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.TextTemplating", "14.0.0.0")]
    public partial class EntityInterfaceImplementation : EntityInterfaceTemplate
    {
#line hidden
        /// <summary>
        /// Create the template output
        /// </summary>
        public override string TransformText()
        {
            this.Write("\r\n");
            
            #line 8 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 foreach(var u in Using) { 
            
            #line default
            #line hidden
            this.Write("using ");
            
            #line 9 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(u));
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 10 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 } 
            
            #line default
            #line hidden
            this.Write("\r\n// ReSharper disable once CheckNamespace\r\nnamespace ");
            
            #line 13 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(OwnNamespace));
            
            #line default
            #line hidden
            this.Write("\r\n{\r\n\tpublic partial class @");
            
            #line 15 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(Name));
            
            #line default
            #line hidden
            this.Write(" : ");
            
            #line 15 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(Interface));
            
            #line default
            #line hidden
            this.Write("\r\n\t{\r\n");
            
            #line 17 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
	var valueSelects = new string[] {"IfcValue", "IfcMetricValueSelect", "IfcAppliedValueSelect", "IfcObjectReferenceSelect"};
	foreach(var attribute in ExplicitAttributesToImplement.ToList()){ 
            
            #line default
            #line hidden
            
            #line 19 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		var match = GetMatch(attribute); 
		if (match == null && IsNew(attribute)) { 
            
            #line default
            #line hidden
            this.Write("\r\n\t\tprivate  ");
            
            #line 22 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(attribute)));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 22 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write(";\r\n\r\n");
            
            #line 24 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		} else if (match != null && attribute.Domain is SelectType && match.SourceAttribute.Domain is EntityDefinition) { 
            
            #line default
            #line hidden
            this.Write("\r\n\t\tprivate  ");
            
            #line 26 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(attribute)));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 26 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4;\r\n\r\n");
            
            #line 28 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		} else if (match != null && attribute.Domain is SelectType && valueSelects.Any(s => s == ((SelectType)attribute.Domain).Name)) { 
            
            #line default
            #line hidden
            this.Write("\r\n\t\tprivate  ");
            
            #line 30 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(attribute)));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 30 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4;\r\n\r\n");
            
            #line 32 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		} 
            
            #line default
            #line hidden
            this.Write("\r\n\t\t[CrossSchemaAttribute(typeof(");
            
            #line 34 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(Interface));
            
            #line default
            #line hidden
            this.Write("), ");
            
            #line 34 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetRemoteOrder(attribute)));
            
            #line default
            #line hidden
            this.Write(")]\r\n\t\t");
            
            #line 35 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(attribute)));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 35 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture("I" + attribute.ParentEntity.Name));
            
            #line default
            #line hidden
            this.Write(".");
            
            #line 35 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write(" \r\n\t\t{ \r\n\t\t\tget\r\n\t\t\t{\r\n");
            
            #line 39 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		if (match == null || !match.IsTypeCompatible) { 
			if (IsNew(attribute)) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\treturn ");
            
            #line 41 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 42 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} else { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t//## Handle return of ");
            
            #line 43 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write(" for which no match was found\r\n\t\t\t\t//TODO: Handle return of ");
            
            #line 44 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write(" for which no match was found\r\n\t\t\t\tthrow new System.NotImplementedException();\r\n\t" +
                    "\t\t\t//##\r\n");
            
            #line 47 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			}  
            
            #line default
            #line hidden
            
            #line 48 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		} else if (attribute.Domain is DefinedType) { 
            
            #line default
            #line hidden
            
            #line 49 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			if (match.SourceAttribute.OptionalFlag) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\tif (!");
            
            #line 50 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(".HasValue) return null;\r\n\t\t\t\treturn new ");
            
            #line 51 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(attribute).Trim('?')));
            
            #line default
            #line hidden
            this.Write("(");
            
            #line 51 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(".Value);\r\n");
            
            #line 52 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} else { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\treturn new ");
            
            #line 53 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(attribute).Trim('?')));
            
            #line default
            #line hidden
            this.Write("(");
            
            #line 53 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(");\r\n");
            
            #line 54 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} 
            
            #line default
            #line hidden
            
            #line 55 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		} else if (attribute.Domain is EntityDefinition) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\treturn ");
            
            #line 56 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            
            #line 56 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 if(!IsDirectTypeMatch(match)) {
            
            #line default
            #line hidden
            this.Write(" as ");
            
            #line 56 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(attribute)));
            
            #line default
            #line hidden
            
            #line 56 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 } 
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 57 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		} else if (attribute.Domain is SelectType && match.SourceAttribute.Domain is EntityDefinition) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\treturn  ");
            
            #line 58 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4 ?? ");
            
            #line 58 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 59 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		} else if (attribute.Domain is SelectType) { 
            
            #line default
            #line hidden
            
            #line 60 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			if (valueSelects.Any(s => s == ((SelectType)attribute.Domain).Name)) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\tif (");
            
            #line 61 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4 != null) return ");
            
            #line 61 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4;\r\n");
            
            #line 62 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 } 
            
            #line default
            #line hidden
            this.Write("\t\t\t\tif (");
            
            #line 63 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(" == null) return null;\r\n");
            
            #line 64 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 			foreach(var st in GetAllSpecific((SelectType)match.SourceAttribute.Domain)) {
				var ed = st as EntityDefinition;
				if(ed != null) {
            
            #line default
            #line hidden
            this.Write("\t\t\t\tvar ");
            
            #line 67 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name.ToString().ToLower()));
            
            #line default
            #line hidden
            this.Write(" = ");
            
            #line 67 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(" as ");
            
            #line 67 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(st)));
            
            #line default
            #line hidden
            this.Write(";\r\n\t\t\t\tif (");
            
            #line 68 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name.ToString().ToLower()));
            
            #line default
            #line hidden
            this.Write(" != null) \r\n");
            
            #line 69 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					if (IsInSelect(ed, match.TargetAttribute.Domain as SelectType)) {
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\treturn ");
            
            #line 70 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name.ToString().ToLower()));
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 71 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					} else { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\t//## Handle entity ");
            
            #line 72 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name));
            
            #line default
            #line hidden
            this.Write(" which is not a part of the target select interface ");
            
            #line 72 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(attribute)));
            
            #line default
            #line hidden
            this.Write(" in property ");
            
            #line 72 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\t//TODO: Handle entity ");
            
            #line 73 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name));
            
            #line default
            #line hidden
            this.Write(" which is not a part of the target select interface ");
            
            #line 73 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(attribute)));
            
            #line default
            #line hidden
            this.Write(" in property ");
            
            #line 73 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\tthrow new System.NotImplementedException();\r\n\t\t\t\t\t//##\r\n");
            
            #line 76 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					} 
            
            #line default
            #line hidden
            
            #line 77 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
				} else if(st is DefinedType){ 
					var dt = st as DefinedType;
					var targetDt = GetMappedDefinedType(dt);
            
            #line default
            #line hidden
            this.Write("\t\t\t\tif (");
            
            #line 80 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(" is ");
            
            #line 80 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(dt)));
            
            #line default
            #line hidden
            this.Write(") \r\n");
            
            #line 81 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					if (targetDt != null && IsInSelect(targetDt, match.TargetAttribute.Domain as SelectType)) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\treturn new ");
            
            #line 82 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(targetDt)));
            
            #line default
            #line hidden
            this.Write("((");
            
            #line 82 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(dt)));
            
            #line default
            #line hidden
            this.Write(")");
            
            #line 82 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(");\r\n");
            
            #line 83 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					} else { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\t//## Handle defined type ");
            
            #line 84 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name));
            
            #line default
            #line hidden
            this.Write(" which is not a part of the target select interface ");
            
            #line 84 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(attribute)));
            
            #line default
            #line hidden
            this.Write(" in property ");
            
            #line 84 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\t//TODO: Handle defined type ");
            
            #line 85 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name));
            
            #line default
            #line hidden
            this.Write(" which is not a part of the target select interface ");
            
            #line 85 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(attribute)));
            
            #line default
            #line hidden
            this.Write(" in property ");
            
            #line 85 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\tthrow new System.NotImplementedException();\r\n\t\t\t\t\t//##\r\n");
            
            #line 88 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					}
            
            #line default
            #line hidden
            
            #line 89 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
				} else { 
					throw new Exception("Unexpected type (enum?)");
				} 
            
            #line default
            #line hidden
            
            #line 92 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} 
            
            #line default
            #line hidden
            this.Write("\t\t\t\treturn null;\r\n");
            
            #line 94 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		} else if (attribute.Domain is SimpleType) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\treturn ");
            
            #line 95 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 96 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		} else if (attribute.Domain is EnumerationType) { 
			var enu = match.SourceAttribute.Domain as EnumerationType;
			var tEnum = GetMappedEnumerationType(enu);
			if (tEnum == null) {
            
            #line default
            #line hidden
            this.Write("\t\t\t\t//## Handle enumeration ");
            
            #line 100 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(enu.Name));
            
            #line default
            #line hidden
            this.Write(" translation in property ");
            
            #line 100 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t//TODO: Handle enumeration ");
            
            #line 101 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(enu.Name));
            
            #line default
            #line hidden
            this.Write(" translation in property ");
            
            #line 101 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\tthrow new System.NotImplementedException();\r\n\t\t\t\t//##\r\n");
            
            #line 104 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} else {
            
            #line default
            #line hidden
            this.Write("\t\t\t\t//## Custom code to handle enumeration of ");
            
            #line 105 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t//##\r\n\t\t\t\tswitch (");
            
            #line 107 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(")\r\n\t\t\t\t{\r\n");
            
            #line 109 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
				foreach(var e in enu.Elements) {
					var translated = GetEnumEquivalent(e, tEnum);
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\tcase ");
            
            #line 111 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(enu)));
            
            #line default
            #line hidden
            this.Write(".");
            
            #line 111 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(e));
            
            #line default
            #line hidden
            this.Write(":\r\n");
            
            #line 112 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					if (e == "USERDEFINED"){ 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\t\t//## Optional custom handling of ");
            
            #line 113 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write(" == .USERDEFINED. \r\n\t\t\t\t\t\t//##\r\n");
            
            #line 115 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					} 
  					if (string.IsNullOrWhiteSpace(translated)){
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\t\t//## Handle translation of ");
            
            #line 117 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(e));
            
            #line default
            #line hidden
            this.Write(" member from ");
            
            #line 117 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(enu.Name));
            
            #line default
            #line hidden
            this.Write(" in property ");
            
            #line 117 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\t\t//TODO: Handle translation of ");
            
            #line 118 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(e));
            
            #line default
            #line hidden
            this.Write(" member from ");
            
            #line 118 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(enu.Name));
            
            #line default
            #line hidden
            this.Write(" in property ");
            
            #line 118 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\t\tthrow new System.NotImplementedException();\r\n\t\t\t\t\t\t//##\r\n");
            
            #line 121 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					} else { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\t\treturn ");
            
            #line 122 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(tEnum)));
            
            #line default
            #line hidden
            this.Write(".");
            
            #line 122 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(e));
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 123 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					}					
				} 
				if (match.SourceAttribute.OptionalFlag) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\tcase null: \r\n\t\t\t\t\t\treturn null;\r\n");
            
            #line 128 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
				} 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\t\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tthrow new System.ArgumentOutOfRangeException();\r\n\t\t\t\t" +
                    "}\r\n");
            
            #line 132 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			}
        } else if(attribute.Domain is AggregationType) {
            
            #line default
            #line hidden
            
            #line 134 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			var targetType =  (attribute.Domain as AggregationType).ElementType as NamedType; 
			var sourceType = (match.SourceAttribute.Domain as AggregationType).ElementType as NamedType; 
            
            #line default
            #line hidden
            
            #line 136 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			if (IsAggregationEntityCompatible(match.SourceAttribute, attribute)) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\r\n\t\t\t\treturn new Common.Collections.ProxyItemSet<");
            
            #line 137 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(sourceType)));
            
            #line default
            #line hidden
            this.Write(", ");
            
            #line 137 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(targetType)));
            
            #line default
            #line hidden
            this.Write(">(");
            
            #line 137 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(");\r\n");
            
            #line 138 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} else if (targetType is DefinedType && sourceType is DefinedType) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\r\n\t\t\t\treturn new Common.Collections.ProxyValueSet<");
            
            #line 139 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(sourceType)));
            
            #line default
            #line hidden
            this.Write(", ");
            
            #line 139 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(targetType)));
            
            #line default
            #line hidden
            this.Write(">(");
            
            #line 139 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(", \r\n\t\t\t\t\ts => new ");
            
            #line 140 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(targetType)));
            
            #line default
            #line hidden
            this.Write("(s), \r\n\t\t\t\t\tt => new ");
            
            #line 141 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(sourceType)));
            
            #line default
            #line hidden
            this.Write("(t));\r\n");
            
            #line 142 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} else { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\r\n\t\t\t\treturn ");
            
            #line 143 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("Ifc4 ?? (");
            
            #line 143 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("Ifc4 = new Common.Collections.ExtendedItemSet<");
            
            #line 143 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(sourceType)));
            
            #line default
            #line hidden
            this.Write(", ");
            
            #line 143 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(targetType)));
            
            #line default
            #line hidden
            this.Write(">(\r\n                    ");
            
            #line 144 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(", \r\n                    new ItemSet<");
            
            #line 145 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(targetType)));
            
            #line default
            #line hidden
            this.Write(">(this, 0, -");
            
            #line 145 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetRemoteOrder(attribute)));
            
            #line default
            #line hidden
            this.Write("), \r\n");
            
            #line 146 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
				if (sourceType.Name == "IfcValue") { 
            
            #line default
            #line hidden
            this.Write("                    v => v.ToIfc4(), \r\n                    v => v.ToIfc3()));\r\n");
            
            #line 149 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 }			else { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\t");
            
            #line 150 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write("ToIfc4, \r\n                    ");
            
            #line 151 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write("ToIfc2X3));\r\n");
            
            #line 152 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
				} 
            
            #line default
            #line hidden
            
            #line 153 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} 
            
            #line default
            #line hidden
            
            #line 154 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		} else { 
			throw new Exception("Unexpected attribute type");
		} 
            
            #line default
            #line hidden
            this.Write("\t\t\t} \r\n");
            
            #line 158 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		if(!IsAggregation(attribute)){ 
            
            #line default
            #line hidden
            this.Write("\t\t\tset\r\n\t\t\t{\r\n");
            
            #line 161 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		if (match == null || !match.IsTypeCompatible) { 
			if (IsNew(attribute)) {
            
            #line default
            #line hidden
            this.Write("\t\t\t\tSetValue(v => ");
            
            #line 163 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write(" = v, ");
            
            #line 163 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write(", value, \"");
            
            #line 163 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\", -");
            
            #line 163 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetRemoteOrder(attribute)));
            
            #line default
            #line hidden
            this.Write(");\r\n");
            
            #line 164 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} else if (match != null && IsSimpleTypeCompatible(attribute, match.SourceAttribute)){ 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t");
            
            #line 165 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(" = value;\r\n");
            
            #line 166 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} else { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t//## Handle setting of ");
            
            #line 167 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write(" for which no match was found\r\n\t\t\t\t//TODO: Handle setting of ");
            
            #line 168 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write(" for which no match was found\r\n\t\t\t\tthrow new System.NotImplementedException();\r\n\t" +
                    "\t\t\t//##\r\n");
            
            #line 171 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
				if (match == null ||( match != null && attribute.Name != match.SourceAttribute.Name)) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\tNotifyPropertyChanged(\"");
            
            #line 172 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\");\r\n");
            
            #line 173 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
				} 
            
            #line default
            #line hidden
            
            #line 174 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} 
            
            #line default
            #line hidden
            
            #line 175 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		} else if (attribute.Domain is DefinedType) { 
            
            #line default
            #line hidden
            
            #line 176 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			if (attribute.OptionalFlag) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t");
            
            #line 177 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(" = value.HasValue ? \r\n\t\t\t\t\tnew ");
            
            #line 178 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(match.SourceAttribute).Trim('?')));
            
            #line default
            #line hidden
            this.Write("(value.Value) :  \r\n\t\t\t\t\t");
            
            #line 179 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 if (match.SourceAttribute.OptionalFlag) {  
            
            #line default
            #line hidden
            this.Write(" new ");
            
            #line 179 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(match.SourceAttribute).Trim('?')));
            
            #line default
            #line hidden
            this.Write("?() ");
            
            #line 179 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 } else { 
            
            #line default
            #line hidden
            this.Write(" default(");
            
            #line 179 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(match.SourceAttribute)));
            
            #line default
            #line hidden
            this.Write(") ");
            
            #line 179 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 } 
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 180 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} else { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t");
            
            #line 181 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(" = new ");
            
            #line 181 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(match.SourceAttribute).Trim('?')));
            
            #line default
            #line hidden
            this.Write("(value);\r\n");
            
            #line 182 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} 
            
            #line default
            #line hidden
            
            #line 183 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		} else if (attribute.Domain is EntityDefinition) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t");
            
            #line 184 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(" = value as ");
            
            #line 184 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(match.SourceAttribute)));
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 185 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		}  else if (attribute.Domain is SelectType && match.SourceAttribute.Domain is EntityDefinition) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\tif (value == null)\r\n\t\t\t\t{\r\n\t\t\t\t\t");
            
            #line 188 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(" = null;\r\n\t\t\t\t\tif (");
            
            #line 189 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4 != null)\r\n\t\t\t\t\t\tSetValue(v => ");
            
            #line 190 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4 = v, ");
            
            #line 190 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4, null, \"");
            
            #line 190 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\", -");
            
            #line 190 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetRemoteOrder(attribute)));
            
            #line default
            #line hidden
            this.Write(");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvar val = value as ");
            
            #line 194 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(match.SourceAttribute)));
            
            #line default
            #line hidden
            this.Write(";\r\n\t\t\t\tif (val != null)\r\n\t\t\t\t{\r\n\t\t\t\t\t");
            
            #line 197 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(" = val;\r\n\t\t\t\t\tif (");
            
            #line 198 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4 != null)\r\n\t\t\t\t\t\tSetValue(v => ");
            
            #line 199 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4 = v, ");
            
            #line 199 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4, null, \"");
            
            #line 199 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\", -");
            
            #line 199 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetRemoteOrder(attribute)));
            
            #line default
            #line hidden
            this.Write(");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t} \r\n\r\n\t\t\t\tif(");
            
            #line 203 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(" != null)\r\n\t\t\t\t\t");
            
            #line 204 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(" = null;\r\n\t\t\t\tSetValue(v => ");
            
            #line 205 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4 = v, ");
            
            #line 205 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4, value, \"");
            
            #line 205 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\", -");
            
            #line 205 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetRemoteOrder(attribute)));
            
            #line default
            #line hidden
            this.Write(");\r\n");
            
            #line 206 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		} else if (attribute.Domain is SimpleType) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t");
            
            #line 207 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(" = value;\r\n");
            
            #line 208 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		} else if (attribute.Domain is SelectType) { 
			var addedEntities = GetAddedEntities(match.SourceAttribute.Domain as SelectType, attribute.Domain as SelectType).ToList(); 
			var addedDefinedTypes = GetAddedDefinedTypes(match.SourceAttribute.Domain as SelectType, attribute.Domain as SelectType).ToList(); 

            
            #line default
            #line hidden
            this.Write("\t\t\t\tif (value == null)\r\n\t\t\t\t{\r\n\t\t\t\t\t");
            
            #line 214 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(" = null;\r\n");
            
            #line 215 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			if (valueSelects.Any(s => s == ((SelectType)attribute.Domain).Name)) {
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\tif (");
            
            #line 216 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4 != null)\r\n\t\t\t\t\t\tSetValue(v => ");
            
            #line 217 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4 = v, ");
            
            #line 217 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4, null, \"");
            
            #line 217 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\", -");
            
            #line 217 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetRemoteOrder(attribute)));
            
            #line default
            #line hidden
            this.Write(");\r\n");
            
            #line 218 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\treturn;\r\n\t\t\t\t}\t\r\n");
            
            #line 221 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 			foreach(var st in GetAllSpecificNative((SelectType)attribute.Domain)) {
				var ed = st as EntityDefinition;
				if(ed != null) {
            
            #line default
            #line hidden
            this.Write("\t\t\t\tvar ");
            
            #line 224 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name.ToString().ToLower()));
            
            #line default
            #line hidden
            this.Write(" = value as ");
            
            #line 224 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(st)));
            
            #line default
            #line hidden
            this.Write(";\r\n\t\t\t\tif (");
            
            #line 225 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name.ToString().ToLower()));
            
            #line default
            #line hidden
            this.Write(" != null) \r\n\t\t\t\t{\r\n");
            
            #line 227 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					if (IsInSelect(ed, match.SourceAttribute.Domain as SelectType)) {
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\t");
            
            #line 228 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(" = ");
            
            #line 228 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name.ToString().ToLower()));
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 229 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
						if (valueSelects.Any(s => s == ((SelectType)attribute.Domain).Name)) {
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\tif (");
            
            #line 230 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4 != null)\r\n\t\t\t\t\t\tSetValue(v => ");
            
            #line 231 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4 = v, ");
            
            #line 231 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4, null, \"");
            
            #line 231 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\", -");
            
            #line 231 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetRemoteOrder(attribute)));
            
            #line default
            #line hidden
            this.Write(");\r\n");
            
            #line 232 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
						} 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\treturn;\r\n");
            
            #line 234 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					} else { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\t//## Handle setting of entity ");
            
            #line 235 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name));
            
            #line default
            #line hidden
            this.Write(" which is not a part of the target select interface ");
            
            #line 235 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(attribute)));
            
            #line default
            #line hidden
            this.Write(" in property ");
            
            #line 235 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\t//TODO: Handle setting of entity ");
            
            #line 236 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name));
            
            #line default
            #line hidden
            this.Write(" which is not a part of the target select interface ");
            
            #line 236 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(attribute)));
            
            #line default
            #line hidden
            this.Write(" in property ");
            
            #line 236 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\tthrow new System.NotImplementedException();\r\n\t\t\t\t\t//##\r\n");
            
            #line 239 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					} 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t}\r\n");
            
            #line 241 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
				} else if(st is DefinedType){ 
					var dt = st as DefinedType;
					var sourceDt = GetMappedDefinedType(dt);
            
            #line default
            #line hidden
            this.Write("\t\t\t\tif (value is ");
            
            #line 244 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(dt)));
            
            #line default
            #line hidden
            this.Write(") \r\n\t\t\t\t{\r\n");
            
            #line 246 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					if (valueSelects.Any(s => s == ((SelectType)attribute.Domain).Name)) {
            
            #line default
            #line hidden
            
            #line 247 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
						if (sourceDt != null && IsInSelect(sourceDt, match.SourceAttribute.Domain as SelectType)) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\t");
            
            #line 248 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(" = new ");
            
            #line 248 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(sourceDt)));
            
            #line default
            #line hidden
            this.Write("((");
            
            #line 248 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(dt)));
            
            #line default
            #line hidden
            this.Write(")value);\r\n\t\t\t\t\tif (");
            
            #line 249 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4 != null)\r\n\t\t\t\t\t\tSetValue(v => ");
            
            #line 250 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4 = v, ");
            
            #line 250 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4, null, \"");
            
            #line 250 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\", -");
            
            #line 250 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetRemoteOrder(attribute)));
            
            #line default
            #line hidden
            this.Write(");\r\n\t\t\t\t\treturn;\r\n");
            
            #line 252 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
						} else { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\tif (");
            
            #line 253 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(" != null)\r\n\t\t\t\t\t\t");
            
            #line 254 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(" = null;\r\n\t\t\t\t\tSetValue(v => ");
            
            #line 255 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4 = v, ");
            
            #line 255 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("4, value, \"");
            
            #line 255 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\", -");
            
            #line 255 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetRemoteOrder(attribute)));
            
            #line default
            #line hidden
            this.Write(");\r\n\t\t\t\t\treturn;\r\n");
            
            #line 257 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
						}
            
            #line default
            #line hidden
            
            #line 258 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					} else { 
            
            #line default
            #line hidden
            
            #line 259 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					if (sourceDt != null && IsInSelect(sourceDt, match.SourceAttribute.Domain as SelectType)) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\t");
            
            #line 260 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(" = new ");
            
            #line 260 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(sourceDt)));
            
            #line default
            #line hidden
            this.Write("((");
            
            #line 260 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(dt)));
            
            #line default
            #line hidden
            this.Write(")value);\r\n\t\t\t\t\treturn;\r\n");
            
            #line 262 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					} else { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\t//## Handle setting of defined type ");
            
            #line 263 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name));
            
            #line default
            #line hidden
            this.Write(" which is not a part of the target select interface ");
            
            #line 263 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(attribute)));
            
            #line default
            #line hidden
            this.Write(" in property ");
            
            #line 263 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\t//TODO: Handle setting of defined type ");
            
            #line 264 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name));
            
            #line default
            #line hidden
            this.Write(" which is not a part of the target select interface ");
            
            #line 264 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(attribute)));
            
            #line default
            #line hidden
            this.Write(" in property ");
            
            #line 264 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\tthrow new System.NotImplementedException();\r\n\t\t\t\t\t//##\r\n");
            
            #line 267 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					}}
            
            #line default
            #line hidden
            this.Write("\t\t\t\t}\r\n");
            
            #line 269 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
				} else { 
					throw new Exception("Unexpected type (enum?)");
				} 
            
            #line default
            #line hidden
            
            #line 272 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} 
            
            #line default
            #line hidden
            
            #line 273 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		} else if (attribute.Domain is EnumerationType) { 
			var enu = attribute.Domain as EnumerationType;
			var tEnum = GetMappedEnumerationType(enu);
			if (tEnum == null) {
            
            #line default
            #line hidden
            this.Write("\t\t\t\t//## Handle setting of  enumeration ");
            
            #line 277 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(enu.Name));
            
            #line default
            #line hidden
            this.Write(" translation in property ");
            
            #line 277 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t//TODO: Handle setting of enumeration ");
            
            #line 278 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(enu.Name));
            
            #line default
            #line hidden
            this.Write(" translation in property ");
            
            #line 278 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\tthrow new System.NotImplementedException();\r\n\t\t\t\t//##\r\n");
            
            #line 281 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} else {
            
            #line default
            #line hidden
            this.Write("\t\t\t\t//## Custom code to handle setting of enumeration of ");
            
            #line 282 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t//##\r\n\t\t\t\tswitch (value)\r\n\t\t\t\t{\r\n");
            
            #line 286 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
				foreach(var e in enu.Elements) {
					var translated = GetEnumEquivalent(e, tEnum);
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\tcase ");
            
            #line 288 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(enu)));
            
            #line default
            #line hidden
            this.Write(".");
            
            #line 288 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(e));
            
            #line default
            #line hidden
            this.Write(":\r\n");
            
            #line 289 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					if (string.IsNullOrWhiteSpace(translated)){
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\t\t//## Handle setting of ");
            
            #line 290 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(e));
            
            #line default
            #line hidden
            this.Write(" member from ");
            
            #line 290 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(enu.Name));
            
            #line default
            #line hidden
            this.Write(" in property ");
            
            #line 290 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\t\t//TODO: Handle setting of ");
            
            #line 291 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(e));
            
            #line default
            #line hidden
            this.Write(" member from ");
            
            #line 291 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(enu.Name));
            
            #line default
            #line hidden
            this.Write(" in property ");
            
            #line 291 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\t\tthrow new System.NotImplementedException();\r\n\t\t\t\t\t\t//##\r\n\t\t\t\t\t");
            
            #line 294 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 } else { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\t\t");
            
            #line 295 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(" = ");
            
            #line 295 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(tEnum)));
            
            #line default
            #line hidden
            this.Write(".");
            
            #line 295 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(e));
            
            #line default
            #line hidden
            this.Write(";\r\n\t\t\t\t\t\treturn;\r\n");
            
            #line 297 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					} 					
  				} 
				if (attribute.OptionalFlag) { 
					if (match.SourceAttribute.OptionalFlag) {
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\t\r\n\t\t\t\t\tcase null:\r\n\t\t\t\t\t\t");
            
            #line 302 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(" = null;\r\n\t\t\t\t\t\treturn;\r\n");
            
            #line 304 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					} else { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\tcase null:\r\n\t\t\t\t\t\t");
            
            #line 306 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(match.SourceAttribute.Name));
            
            #line default
            #line hidden
            this.Write(" = ");
            
            #line 306 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(tEnum)));
            
            #line default
            #line hidden
            this.Write(".");
            
            #line 306 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetDefaultEnumMember(GetCSTypeFull(tEnum))));
            
            #line default
            #line hidden
            this.Write(";\r\n\t\t\t\t\t\treturn;\r\n");
            
            #line 308 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					}
				} 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tthrow new System.ArgumentOutOfRangeException();\r\n\t\t\t\t}\r\n");
            
            #line 313 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			}
        } 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\r\n\t\t\t}\r\n");
            
            #line 316 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		} 
            
            #line default
            #line hidden
            this.Write("\t\t}\r\n");
            
            #line 318 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
	if (attribute.Domain is AggregationType && match != null && match.IsTypeCompatible && !IsAggregationEntityCompatible(match.SourceAttribute, attribute)) { 
            
            #line default
            #line hidden
            
            #line 319 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			var targetType =  (attribute.Domain as AggregationType).ElementType; 
			var sourceType = (match.SourceAttribute.Domain as AggregationType).ElementType; 
            
            #line default
            #line hidden
            
            #line 321 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
  if (!(targetType is DefinedType) || !(sourceType is DefinedType)) { 
            
            #line default
            #line hidden
            this.Write("\r\n\t\t//private field to hold any extended data\r\n\t\tprivate ");
            
            #line 324 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(attribute)));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 324 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetPrivateFieldName(attribute)));
            
            #line default
            #line hidden
            this.Write("Ifc4;\r\n");
            
            #line 325 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
  if ((sourceType as NamedType)?.Name != "IfcValue") { 
            
            #line default
            #line hidden
            this.Write("\t\t//transformation function to convert/cast IFC2x3 data to appear as IFC4\r\n\t\tpriv" +
                    "ate static ");
            
            #line 327 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(targetType as NamedType)));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 327 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("ToIfc4 (");
            
            #line 327 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(sourceType as NamedType)));
            
            #line default
            #line hidden
            this.Write(" member)\r\n\t\t{\r\n");
            
            #line 329 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			if (targetType is DefinedType) { 
            
            #line default
            #line hidden
            this.Write("\t\t\treturn new ");
            
            #line 330 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(targetType as NamedType)));
            
            #line default
            #line hidden
            this.Write("(member);\r\n");
            
            #line 331 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} else if (targetType is SimpleType) { 
            
            #line default
            #line hidden
            this.Write("\t\t\treturn member;\r\n");
            
            #line 333 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} else if (targetType is EntityDefinition) { 
            
            #line default
            #line hidden
            this.Write("\t\t\treturn member;\r\n");
            
            #line 335 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} else if (targetType is SelectType && !(sourceType is SelectType)) { 
            
            #line default
            #line hidden
            
            #line 336 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
				if (sourceType is EntityDefinition) { 
            
            #line default
            #line hidden
            this.Write("\t\t\treturn member;\r\n");
            
            #line 338 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
				} else if(sourceType is DefinedType) {
					var dt = sourceType as DefinedType;
					var targetDt = GetMappedDefinedType(dt); 
            
            #line default
            #line hidden
            this.Write("\t\t\treturn new ");
            
            #line 341 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(targetDt)));
            
            #line default
            #line hidden
            this.Write("((");
            
            #line 341 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetBaseSystemType(dt)));
            
            #line default
            #line hidden
            this.Write(")(");
            
            #line 341 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(dt)));
            
            #line default
            #line hidden
            this.Write(")member);\r\n");
            
            #line 342 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
				} 
            
            #line default
            #line hidden
            
            #line 343 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} else if (targetType is SelectType) { 
            
            #line default
            #line hidden
            this.Write("\t\t\tif (member == null) \r\n\t\t\t\treturn null;\r\n\t\t\tswitch (member.GetType().Name)\r\n\t\t\t" +
                    "{\r\n");
            
            #line 348 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 				foreach(var st in GetAllSpecific((SelectType)sourceType)) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\tcase \"");
            
            #line 349 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name));
            
            #line default
            #line hidden
            this.Write("\":\r\n");
            
            #line 350 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					var ed = st as EntityDefinition;
					if(ed != null) {
            
            #line default
            #line hidden
            
            #line 352 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
						if (IsInSelect(ed, targetType as SelectType)) {
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\treturn member as ");
            
            #line 353 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(st)));
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 354 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
						} else { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\t//## Handle entity ");
            
            #line 355 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name));
            
            #line default
            #line hidden
            this.Write(" which is not a part of the target select interface ");
            
            #line 355 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(targetType as NamedType)));
            
            #line default
            #line hidden
            this.Write(" in property ");
            
            #line 355 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\t//TODO: Handle entity ");
            
            #line 356 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name));
            
            #line default
            #line hidden
            this.Write(" which is not a part of the target select interface ");
            
            #line 356 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(targetType as NamedType)));
            
            #line default
            #line hidden
            this.Write(" in property ");
            
            #line 356 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\tthrow new System.NotImplementedException();\r\n\t\t\t\t\t//##\r\n");
            
            #line 359 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
						} 
            
            #line default
            #line hidden
            
            #line 360 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					} else if (st is DefinedType) { 
						var dt = st as DefinedType;
						var targetDt = GetMappedDefinedType(dt);
            
            #line default
            #line hidden
            
            #line 363 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
						if (targetDt != null && IsInSelect(targetDt, targetType as SelectType) && !(targetDt.Domain is EnumerationType)) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\treturn new ");
            
            #line 364 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(targetDt)));
            
            #line default
            #line hidden
            this.Write("((");
            
            #line 364 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(dt)));
            
            #line default
            #line hidden
            this.Write(")member);\r\n");
            
            #line 365 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
						} else { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\t//## Handle defined type ");
            
            #line 366 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name));
            
            #line default
            #line hidden
            this.Write(" which is not a part of the target select interface ");
            
            #line 366 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(attribute)));
            
            #line default
            #line hidden
            this.Write(" in property ");
            
            #line 366 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\t//TODO: Handle defined type ");
            
            #line 367 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name));
            
            #line default
            #line hidden
            this.Write(" which is not a part of the target select interface ");
            
            #line 367 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(attribute)));
            
            #line default
            #line hidden
            this.Write(" in property ");
            
            #line 367 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\tthrow new System.NotImplementedException();\r\n\t\t\t\t\t//##\r\n");
            
            #line 370 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
						}
            
            #line default
            #line hidden
            
            #line 371 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					} else if (st is EnumerationType) { 
						Console.WriteLine("Enumeration found as a select member. This is legal in EXPRESS schema but not supported in our implementation");
					} else { 
						throw new Exception("Unexpected type (enum?)");
					} 
            
            #line default
            #line hidden
            
            #line 376 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
				} 
            
            #line default
            #line hidden
            this.Write("\t\t\t\tdefault:\r\n\t\t\t\t\tthrow new System.NotSupportedException();\r\n\t\t\t}\r\n");
            
            #line 380 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} else {
				throw new Exception("Not expected"); 
			} 
            
            #line default
            #line hidden
            this.Write("\t\t}\r\n\r\n\t\t//transformation function to convert/cast IFC4 data to appear as IFC2x3 " +
                    "if possible\r\n\t\tprivate static ");
            
            #line 386 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(sourceType as NamedType)));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 386 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("ToIfc2X3 (");
            
            #line 386 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(targetType as NamedType)));
            
            #line default
            #line hidden
            this.Write(" member){\r\n");
            
            #line 387 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			if (sourceType is DefinedType) { 
            
            #line default
            #line hidden
            this.Write("\t\t\treturn new ");
            
            #line 388 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(sourceType as NamedType)));
            
            #line default
            #line hidden
            this.Write("(member);\r\n");
            
            #line 389 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} else if (sourceType is SimpleType) { 
            
            #line default
            #line hidden
            this.Write("\t\t\treturn member;\r\n");
            
            #line 391 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} else if (sourceType is EntityDefinition) { 
            
            #line default
            #line hidden
            this.Write("\t\t\treturn member as ");
            
            #line 392 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(sourceType as NamedType)));
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 393 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} else if (sourceType is SelectType && !(targetType is SelectType)) { 
            
            #line default
            #line hidden
            
            #line 394 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
				if (targetType is EntityDefinition) { 
            
            #line default
            #line hidden
            this.Write("\t\t\treturn member;\r\n");
            
            #line 396 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
				} else if(targetType is DefinedType) {
					var dt = targetType as DefinedType;
					var targetDt = GetMappedDefinedType(dt); 
            
            #line default
            #line hidden
            this.Write("\t\t\treturn new ");
            
            #line 399 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(targetDt)));
            
            #line default
            #line hidden
            this.Write("((");
            
            #line 399 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(dt)));
            
            #line default
            #line hidden
            this.Write(")member);\r\n");
            
            #line 400 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
				} 
            
            #line default
            #line hidden
            
            #line 401 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} else if (sourceType is SelectType) { 
            
            #line default
            #line hidden
            this.Write("\t\t\tif (member == null) \r\n\t\t\t\treturn null;\r\n\t\t\tvar name = member.GetType().Name;\r\n" +
                    "\t\t\tswitch (name)\r\n\t\t\t{\r\n");
            
            #line 407 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 				foreach(var st in GetAllSpecific((SelectType)targetType)) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\tcase \"");
            
            #line 408 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name));
            
            #line default
            #line hidden
            this.Write("\":\r\n");
            
            #line 409 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 					var ed = st as EntityDefinition;
					if(ed != null) {
            
            #line default
            #line hidden
            
            #line 411 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
						if (IsInSelect(ed, sourceType as SelectType)) {
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\treturn member as ");
            
            #line 412 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(st)));
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 413 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
						} else { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\t//## Handle return entity ");
            
            #line 414 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name));
            
            #line default
            #line hidden
            this.Write(" which is not a part of the target select interface ");
            
            #line 414 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(sourceType as NamedType)));
            
            #line default
            #line hidden
            this.Write(" in property ");
            
            #line 414 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\t//TODO: Handle entity ");
            
            #line 415 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name));
            
            #line default
            #line hidden
            this.Write(" which is not a part of the target select interface ");
            
            #line 415 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(sourceType as NamedType)));
            
            #line default
            #line hidden
            this.Write(" in property ");
            
            #line 415 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\tthrow new System.NotImplementedException();\r\n\t\t\t\t\t//##\r\n");
            
            #line 418 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
						} 
            
            #line default
            #line hidden
            
            #line 419 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					} else if (st is DefinedType) { 
						var dt = st as DefinedType;
						var targetDt = GetMappedDefinedType(dt);
            
            #line default
            #line hidden
            
            #line 422 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
						if (targetDt != null && IsInSelect(targetDt, sourceType as SelectType) && !(targetDt.Domain is EnumerationType)) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\treturn new ");
            
            #line 423 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(targetDt)));
            
            #line default
            #line hidden
            this.Write("((");
            
            #line 423 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(dt)));
            
            #line default
            #line hidden
            this.Write(")member);\r\n");
            
            #line 424 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
						} else { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t\t//## Handle return defined type ");
            
            #line 425 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name));
            
            #line default
            #line hidden
            this.Write(" which is not a part of the target select interface ");
            
            #line 425 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(sourceType as NamedType)));
            
            #line default
            #line hidden
            this.Write(" in property ");
            
            #line 425 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\t//TODO: Handle defined type ");
            
            #line 426 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(st.Name));
            
            #line default
            #line hidden
            this.Write(" which is not a part of the target select interface ");
            
            #line 426 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetCSTypeFull(sourceType as NamedType)));
            
            #line default
            #line hidden
            this.Write(" in property ");
            
            #line 426 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\tthrow new System.NotImplementedException();\r\n\t\t\t\t\t//##\r\n");
            
            #line 429 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
						}
            
            #line default
            #line hidden
            
            #line 430 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
					} else if (st is EnumerationType) { 
						Console.WriteLine("Enumeration found as a select member. This is legal in EXPRESS schema but not supported in our implementation");
					} else { 
						throw new Exception("Unexpected type (enum?)");
					} 
            
            #line default
            #line hidden
            
            #line 435 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
				} 
            
            #line default
            #line hidden
            this.Write("\t\t\t\tdefault:\r\n\t\t\t\t\tthrow new System.NotSupportedException();\r\n\t\t\t}\r\n");
            
            #line 439 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} else {
				throw new Exception("Not expected"); 
			} 
            
            #line default
            #line hidden
            this.Write("\t\t}\r\n");
            
            #line 443 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
  } 
            
            #line default
            #line hidden
            
            #line 444 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
  } 
            
            #line default
            #line hidden
            
            #line 445 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
  } 
            
            #line default
            #line hidden
            
            #line 446 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
	} 
            
            #line default
            #line hidden
            
            #line 447 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 foreach(var attribute in InverseAttributesToImplement.ToList()){  
	var inverseType = "I" + attribute.Domain.Name; 
            
            #line default
            #line hidden
            
            #line 449 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 if (IsEnumeration(attribute)) { 
            
            #line default
            #line hidden
            this.Write("\t\tIEnumerable<");
            
            #line 450 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(inverseType));
            
            #line default
            #line hidden
            this.Write("> ");
            
            #line 450 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture("I" + attribute.ParentEntity.Name));
            
            #line default
            #line hidden
            this.Write(".");
            
            #line 450 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write(" \r\n");
            
            #line 451 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 } else { 
            
            #line default
            #line hidden
            this.Write("\t\t");
            
            #line 452 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(inverseType));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 452 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(Interface));
            
            #line default
            #line hidden
            this.Write(".");
            
            #line 452 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write(" \r\n");
            
            #line 453 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 } 
            
            #line default
            #line hidden
            this.Write("\t\t{ \r\n\t\t\tget\r\n\t\t\t{\r\n");
            
            #line 457 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 if (IsDoubleAggregation(attribute)) {
            
            #line default
            #line hidden
            this.Write("\t\t\t\treturn Model.Instances.");
            
            #line 458 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(IsEnumeration(attribute) ? "Where" : "FirstOrDefault"));
            
            #line default
            #line hidden
            this.Write("<");
            
            #line 458 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(inverseType));
            
            #line default
            #line hidden
            this.Write(">(e => e.");
            
            #line 458 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.InvertedAttr.Name));
            
            #line default
            #line hidden
            this.Write(" != null &&  e.");
            
            #line 458 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.InvertedAttr.Name));
            
            #line default
            #line hidden
            this.Write(".Any( i => i.Contains(this)), \"");
            
            #line 458 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.InvertedAttr.Name));
            
            #line default
            #line hidden
            this.Write("\", this);\r\n");
            
            #line 459 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 } else if (IsAggregation(attribute)){
            
            #line default
            #line hidden
            this.Write("\t\t\t\treturn Model.Instances.");
            
            #line 460 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(IsEnumeration(attribute) ? "Where" : "FirstOrDefault"));
            
            #line default
            #line hidden
            this.Write("<");
            
            #line 460 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(inverseType));
            
            #line default
            #line hidden
            this.Write(">(e => e.");
            
            #line 460 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.InvertedAttr.Name));
            
            #line default
            #line hidden
            this.Write(" != null &&  e.");
            
            #line 460 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.InvertedAttr.Name));
            
            #line default
            #line hidden
            this.Write(".Contains(this), \"");
            
            #line 460 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.InvertedAttr.Name));
            
            #line default
            #line hidden
            this.Write("\", this);\r\n");
            
            #line 461 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 } else {
            
            #line default
            #line hidden
            this.Write("\t\t\t\treturn Model.Instances.");
            
            #line 462 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(IsEnumeration(attribute) ? "Where" : "FirstOrDefault"));
            
            #line default
            #line hidden
            this.Write("<");
            
            #line 462 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(inverseType));
            
            #line default
            #line hidden
            this.Write(">(e => (e.");
            
            #line 462 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.InvertedAttr.Name));
            
            #line default
            #line hidden
            this.Write(" as ");
            
            #line 462 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(Name));
            
            #line default
            #line hidden
            this.Write(") == this, \"");
            
            #line 462 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.InvertedAttr.Name));
            
            #line default
            #line hidden
            this.Write("\", this);\r\n");
            
            #line 463 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 } 
            
            #line default
            #line hidden
            this.Write("\t\t\t} \r\n\t\t}\r\n");
            
            #line 466 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
 } 
            
            #line default
            #line hidden
            
            #line 467 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		foreach(var attribute in DerivedAttributesToImplement.ToList()){ 
            
            #line default
            #line hidden
            this.Write("\t\t");
            
            #line 468 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(attribute)));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 468 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetDerivedAttributePlacement(attribute)));
            
            #line default
            #line hidden
            this.Write(".");
            
            #line 468 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write(" \r\n\t\t{\r\n\t\t\tget \r\n\t\t\t{\r\n");
            
            #line 472 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			if (IsDirectDerived(attribute)) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\treturn ");
            
            #line 473 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 474 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} else if (attribute.Domain is DefinedType) { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\treturn new ");
            
            #line 475 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetInterfaceCSTypeFull(attribute)));
            
            #line default
            #line hidden
            this.Write("(");
            
            #line 475 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write(");\r\n");
            
            #line 476 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} else { 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t//## Getter for ");
            
            #line 477 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write(" in an interface\r\n\t\t\t\t//TODO: Implement getter for derived attribute ");
            
            #line 478 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(attribute.Name));
            
            #line default
            #line hidden
            this.Write(" in an interface\r\n\t\t\t\tthrow new System.NotImplementedException();\r\n\t\t\t\t//##\r\n");
            
            #line 481 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
			} 
            
            #line default
            #line hidden
            this.Write("\t\t\t}\r\n\t\t}\r\n\r\n");
            
            #line 485 "c:\Users\Martin\Source\Repos\XbimExpress\Xbim.CodeGeneration\Templates\CrossAccess\EntityInterfaceImplementation.tt"
		} 
            
            #line default
            #line hidden
            this.Write("\t//## Custom code\r\n\t//##\r\n\t}\r\n}");
            return this.GenerationEnvironment.ToString();
        }
    }
    
    #line default
    #line hidden
}
